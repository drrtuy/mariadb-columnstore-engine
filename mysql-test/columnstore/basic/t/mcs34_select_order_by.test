#
# Some basic order by statements #
# Author: Susil, susil.behera@mariadb.com
#

-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcs34_db1;
--enable_warnings

CREATE DATABASE mcs34_db1;
USE mcs34_db1;

#Test with mixed datatypes
CREATE TABLE t1
(
  id INT,
  t1_tinyint TINYINT DEFAULT 0,
  t1_int INT DEFAULT NULL,
  t1_bigint BIGINT,
  t1_double DOUBLE,
  t1_float FLOAT,
  t1_blob BLOB,
  t1_text TEXT,
  t1_char CHAR(1),
  t1_varchar VARCHAR(255) DEFAULT 'hello world!',
  t1_datetime DATETIME
)ENGINE=Columnstore;

INSERT INTO t1 (id, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_datetime)
 VALUES(1, 203685477580676, -3.797693231E+108, -7.402866E+18, repeat('b',100), repeat('b',100), 'b', '2387-11-08 11:22:30');
INSERT INTO t1 (id, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_datetime)
 VALUES(2, 303685477580676, -4.797693231, -8.402866, repeat('b',101), repeat('b',101), 'b', '3387-11-08 11:22:30');
INSERT INTO t1 (id, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_datetime)
 VALUES(3, 403685477580676, +54.797693231, +8.402866, repeat('c',101), repeat('c',101), 'c', '3387-11-08 11:22:30');
INSERT INTO t1 (id, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_datetime)
 VALUES(4, 403685477580677, +54.797693232, +8.402867, repeat('c',101), repeat('c',101), 'c', '3387-11-08 11:22:31');
INSERT INTO t1 (id, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_datetime)
 VALUES(5, 403685477580678, +54.797693233, +8.402868, repeat('c',101), repeat('c',101), 'c', '3387-11-08 11:22:32');
INSERT INTO t1 (id, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_datetime)
 VALUES(6, 403685477580679, +54.797693234, +8.402869, repeat('c',101), repeat('c',101), 'c', '3387-11-08 11:22:33');
INSERT INTO t1 (id, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_datetime)
 VALUES(7, 403685477580680, +54.797693235, +8.402870, repeat('c',101), repeat('c',101), 'c', '3387-11-08 11:22:34');
INSERT INTO t1 (id, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_datetime)
 VALUES(8, 503685477580676, +64.797693231, +9.402866, repeat('2',102), repeat('d',102), 'd', '4387-11-08 11:22:30');
INSERT INTO t1 VALUES(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);


SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 1,2,3,4,5,8,9,10, id;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 1, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 1 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 1 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 2, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 2 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 2 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 3, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 3 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 3 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 4, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 4 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 4 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 5, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 5 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 5 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 6, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 6 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 6 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 7, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 7 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 7 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 8, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 8 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 8 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 9, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 9 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 9 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 10, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 10 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 10 DESC, id ASC;

#ORDER BY multiple columns
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 1, 2, 3, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 1, 2, 3 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 1, 2, 3 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 4, 5, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 4, 5 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 4, 5 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 6, 7, 8, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 6, 7, 8 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 6, 7, 8 DESC, id ASC;

SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 9, 10, id;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 9, 10 ASC, id ASC;
SELECT t1_tinyint, t1_int, t1_bigint, t1_double, t1_float, t1_blob, t1_text, t1_char, t1_varchar, t1_datetime FROM t1 ORDER BY 9, 10 DESC, id ASC;

#Clean up
DROP DATABASE IF EXISTS mcs34_db1;